@if (form.enabled) {
    <p-fluid class="custom-card-form">
        <form [formGroup]="form" class="custom-grid-form" (ngSubmit)="onSubmit()">
            <div class="custom-field-form md:col-span-12">
                <small style="color: var(--primary-color)">
                    Por favor, responda sus preguntas de seguridad.
                </small>
            </div>

            <!-- securityQuestionsField -->
            <div formArrayName="securityQuestions" class="custom-field-form md:col-span-12">
                @for (securityQuestion of securityQuestionsField.controls; track securityQuestion.value.code) {
                    <div [formGroupName]="$index" class="custom-field-form md:col-span-12">
                        <label
                            appLabel
                            [for]="$index"
                            [required]="securityQuestion.get('answer')">
                            {{ securityQuestion.get('question')?.value }}
                        </label>

                        <p-password
                            [id]="$index"
                            [formControl]="$any(securityQuestion.get('answer'))"
                            [toggleMask]="true"
                            [feedback]="false" />

                        <p-message
                            appErrorMessage
                            [errors]="securityQuestion.get('answer')?.errors"
                            [touched]="securityQuestion.get('answer')?.touched"
                            [dirty]="securityQuestion.get('answer')?.dirty" />
                    </div>
                }
            </div>

            <!-- emailField -->
            <div class="custom-field-form md:col-span-12">
                <label
                    appLabel
                    for="email"
                    label="Nuevo Correo electrÃ³nico"
                    [required]="emailField"></label>

                <input pInputText type="email" id="email" formControlName="email" />

                <p-message
                    appErrorMessage
                    [errors]="emailField.errors"
                    [touched]="emailField.touched"
                    [dirty]="emailField.dirty" />
            </div>

            <!-- actions -->
            <div class="custom-field-form md:col-span-6">
                <p-button
                    label="Cambiar preguntas"
                    severity="info"
                    [icon]="FontAwesome.ARROWS_ROTATE_SOLID"
                    (onClick)="generateSecurityQuestions()" />
            </div>

            <div class="custom-field-form md:col-span-6">
                <p-button type="submit" label="Validar y Cambiar Correo" [icon]="FontAwesome.ENVELOPE_OPEN_SOLID" />
            </div>
        </form>
    </p-fluid>
}
